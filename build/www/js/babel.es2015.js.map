{"version":3,"sources":["bonzi.es2015"],"names":["Bonzi","id","userPublic","name","color","speed","pitch","voice","colorPrev","data","window","BonziData","drag","dragged","eventQueue","eventRun","event","willCancel","run","mute","eventTypeToFunc","s4","rng","Math","seedrandom","seed","random","selContainer","$container","$","append","selElement","selDialog","selDialogCont","selNametag","selCanvas","width","size","x","height","y","$element","$canvas","$dialog","$dialogCont","$nametag","updateName","updateSprite","generate_event","a","b","c","e","coords","maxCoords","move","contextMenu","selector","build","$trigger","items","callback","cancel","socket","emit","list","visible","isOwner","word","prompt","reason","animation","duration","show","hide","needsUpdate","runSingleEvent","type","anim","ticks","index","timer","cur","which","drag_start","pageX","pageY","arguments","length","max","min","css","sprite","BonziHandler","updateDialog","push","eventMake","html","clearDialog","stopSpeaking","goingToSpeak","voiceSource","stop","gotoAndPlay","eventNext","talk","text","say","goNext","currentAnimation","pass_idle","indexOf","tmp_idle_start","to_idle","add","floor","unshift","splice","eventType","stage","update","allowHtml","replaceAll","replace","linkify","greentext","substring","speak","play","source","event_list_joke","event_list_fact","setTimeout","removeChild","remove","vid","tag","swag","removeClass","addClass","target","createjs","Sprite","spriteSheets","addChild"],"mappings":"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","file":"babel.es2015.js","sourcesContent":["class Bonzi {\n        constructor(id, userPublic) {\n\n                // ========================================================================\n                // VARIABLES/CONSTANTS\n                // ========================================================================\n                this.userPublic = userPublic || {\n                        name: \"BonziBUDDY\",\n                        color: \"purple\",\n                        speed: 175,\n                        pitch: 50,\n                        voice: \"en-us\"\n                };\n                this.color = this.userPublic.color;\n                this.colorPrev;\n                this.data = window.BonziData;\n\n                this.drag = false;\n                this.dragged = false;\n\n                this.eventQueue = [];\n\n                this.eventRun = true;\n                this.event = null;\n\n                this.willCancel = false;\n\n                this.run = true;\n\n                this.mute = false;\n\n                this.eventTypeToFunc = {\n                        \"anim\": \"updateAnim\",\n                        \"html\": \"updateText\",\n                        \"text\": \"updateText\",\n                        \"idle\": \"updateIdle\",\n                        \"add_random\": \"updateRandom\"\n                };\n\n                // ========================================================================\n                // ASSIGN ID\n                // http://stackoverflow.com/a/105074\n                // ========================================================================\n\n                if (typeof id == \"undefined\") {\n                        this.id = s4() + s4();\n                } else this.id = id;\n\n                this.rng = new Math.seedrandom((this.seed || this.id) || Math.random());\n\n                // ========================================================================\n                // HTML POPULATION\n                // ========================================================================\n                this.selContainer = \"#content\";\n                this.$container = $(this.selContainer);\n                                \n                this.$container.append(`\n                        <div id='bonzi_${this.id}' class='bonzi'>\n                                <div class='bonzi_name'></div>\n                                        <div class='bonzi_placeholder'></div>\n                                <div style='display:none' class='bubble'>\n                                        <p class='bubble-content'></p>\n                                </div>\n                        </div>\n                `);\n\n                this.selElement = \"#bonzi_\" + this.id;\n                this.selDialog = this.selElement + \" > .bubble\";\n                this.selDialogCont = this.selElement + \" > .bubble > p\";\n                this.selNametag = this.selElement + \" > .bonzi_name\";\n\n                this.selCanvas = this.selElement + \" > .bonzi_placeholder\";\n                $(this.selCanvas)\n                        .width(this.data.size.x)\n                        .height(this.data.size.y);\n\n                this.$element   = $(this.selElement);\n                this.$canvas    = $(this.selCanvas);\n                this.$dialog    = $(this.selDialog);\n                this.$dialogCont        = $(this.selDialogCont);\n                this.$nametag   = $(this.selNametag);\n\n                this.updateName();\n\n                $.data(this.$element[0], \"parent\", this);\n\n                this.updateSprite(true);\n\n                // ========================================================================\n                // EVENTS\n                // ========================================================================\n                this.generate_event = function(a, b, c) { // Selector, event, function\n                        a[b](e => { this[c](e); });\n                };\n\n                this.generate_event(\n                        this.$canvas,\n                        \"mousedown\",\n                        \"mousedown\"\n                );\n                \n                this.generate_event(\n                        $(window),\n                        \"mousemove\",\n                        \"mousemove\"\n                );\n                \n                this.generate_event(\n                        $(window),\n                        \"mouseup\",\n                        \"mouseup\"\n                );\n\n                var coords = this.maxCoords();\n                this.x = coords.x * this.rng();\n                this.y = coords.y * this.rng();\n                this.move();\n\n                // ========================================================================\n                // MENU\n                // ========================================================================\n\n                $.contextMenu({\n                        selector: this.selCanvas,\n                        build: ($trigger, e) => {\n                                return { items: {\n                                        \"cancel\": {\n                                                name: \"Cancel\",\n                                                callback: () => { this.cancel(); }\n                                        },\n                                        \"mute\": {\n                                                name: () => this.mute ? \"Unmute\" : \"Mute\",\n                                                callback: () => {\n                                                        this.cancel();\n                                                        this.mute = !this.mute;\n                                                }\n                                        },\n                                        \"asshole\": {\n                                                name: \"Call an Asshole\",\n                                                callback: () => {\n                                                        socket.emit(\"command\", {\n                                                                list: [\"asshole\", this.userPublic.name]\n                                                        });\n                                                }\n                                        },\n                                        \"owo\": {\n                                                name: \"Notice Bulge\",\n                                                callback: () => {\n                                                        socket.emit(\"command\", {\n                                                                list: [\"owo\", this.userPublic.name]\n                                                        });\n                                                }\n                                        },\n                                        \"godword\": {\n                                                name: \"Login as Owner\",\n                                                visible: () => !window.isOwner,\n                                                callback: () => {\n                                                        let word = prompt(\"Enter Godword:\");\n                                                        if (word) {\n                                                                socket.emit(\"command\", {\n                                                                        list: [\"godword\", word]\n                                                                });\n                                                        }\n                                                }\n                                        },\n                                        \"kick\": {\n                                                name: \"Kick\",\n                                                visible: function() { return window.isOwner; },\n                                                callback: () => {\n                                                        let reason = prompt(\"Reason:\");\n                                                        socket.emit(\"command\", {\n                                                                list: [\"kick\", this.id, reason]\n                                                        });\n                                                }\n                                        },\n                                        \"ban\": {\n                                                name: \"Ban\",\n                                                visible: function() { return window.isOwner; },\n                                                items: {\n                                                        \"temp\": {\n                                                                name: \"Tempban\",\n                                                                items: {\n                                                                        \"ban_1m\": { name: \"1 Minute\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 1] }); } },\n                                                                        \"ban_5m\": { name: \"5 Minutes\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 5] }); } },\n                                                                        \"ban_10m\": { name: \"10 Minutes\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 10] }); } },\n                                                                        \"ban_30m\": { name: \"30 Minutes\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 30] }); } },\n                                                                        \"ban_1h\": { name: \"1 Hour\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 60] }); } },\n                                                                        \"ban_2h\": { name: \"2 Hours\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 120] }); } },\n                                                                        \"ban_5h\": { name: \"5 Hours\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 300] }); } },\n                                                                        \"ban_10h\": { name: \"10 Hours\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 600] }); } },\n                                                                        \"ban_16h\": { name: \"16 Hours\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 960] }); } }\n                                                                }\n                                                        },\n                                                        \"perm\": {\n                                                                name: \"Ban\",\n                                                                items: {\n                                                                        \"ban_1d\": { name: \"1 Day\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 1440] }); } },\n                                                                        \"ban_2d\": { name: \"2 Days\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 2880] }); } },\n                                                                        \"ban_3d\": { name: \"3 Days\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 4320] }); } },\n                                                                        \"ban_4d\": { name: \"4 Days\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 5760] }); } },\n                                                                        \"ban_5d\": { name: \"5 Days\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 7200] }); } },\n                                                                        \"ban_6d\": { name: \"6 Days\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 8640] }); } },\n                                                                        \"ban_1w\": { name: \"1 Week\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 10080] }); } },\n                                                                        \"ban_2w\": { name: \"2 Weeks\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 20160] }); } },\n                                                                        \"ban_1mo\": { name: \"1 Month\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 43200] }); } },\n                                                                        \"ban_12mo\": { name: \"12 Months\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 525600] }); } },\n                                                                        \"ban_2y\": { name: \"2 Years\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 1051200] }); } },\n                                                                        \"ban_5y\": { name: \"5 Years\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 2628000] }); } },\n                                                                        \"ban_forever\": { name: \"Permanent (Invalid Date)\", callback: () => { socket.emit(\"command\", { list: [\"ban\", this.id, prompt(\"Reason:\"), 999999999] }); } }\n                                                                }\n                                                        }\n                                                }\n                                        }\n                                } };\n                        },\n                        animation: {\n                                duration: 175,\n                                show: 'fadeIn',\n                                hide: 'fadeOut'\n                        }\n                });\n\n                // ========================================================================\n                // UPDATE LOOP\n                // ========================================================================\n\n                this.needsUpdate = false;\n\n                this.runSingleEvent([{\n                        type: \"anim\",\n                        anim: \"surf_intro\",\n                        ticks: 30\n                }]);\n        }\n\n        eventMake(list) {\n                return {\n                        list: list,\n                        index: 0,\n                        timer: 0,\n                        cur: function() { return this.list[this.index] }\n                };\n        }\n\n        mousedown(e) {\n                if (e.which == 1) {\n                        this.drag = true;\n                        this.dragged = false;\n                        this.drag_start = {\n                                x: e.pageX - this.x,\n                                y: e.pageY - this.y\n                        };\n                }\n        }\n\n        mousemove(e) {\n                if (this.drag) {\n                        this.move(\n                                e.pageX - this.drag_start.x,\n                                e.pageY - this.drag_start.y\n                        );\n                        this.dragged = true;\n                }\n        }\n\n        move(x, y) {\n                if (arguments.length !== 0) {\n                        this.x = x;\n                        this.y = y;\n                }\n                var max = this.maxCoords();\n                this.x = Math.min(\n                        Math.max(0, this.x),\n                        max.x\n                );\n                this.y = Math.min(\n                        Math.max(0, this.y),\n                        max.y\n                );\n                this.$element.css({\n                        \"marginLeft\": this.x,\n                        \"marginTop\": this.y\n                });\n\n                this.sprite.x = this.x;\n                this.sprite.y = this.y;\n                BonziHandler.needsUpdate = true;\n                this.updateDialog();\n        }\n\n        mouseup(e) {\n                if (!this.dragged && this.drag)\n                        this.cancel();\n\n                this.drag = false;\n                this.dragged = false;\n        }\n\n        runSingleEvent(list) {\n                if (!this.mute)\n                        this.eventQueue.push(this.eventMake(list));\n        }\n\n        clearDialog() {\n                this.$dialogCont.html(\"\");\n                this.$dialog.hide();\n        }\n\n        cancel() {\n                this.clearDialog();\n                this.stopSpeaking();\n                this.eventQueue = [this.eventMake([{ type: \"idle\" }])];\n        }\n\n        retry() {\n                this.clearDialog();\n                this.event.timer = 0;\n        }\n\n        stopSpeaking() {\n                this.goingToSpeak = false;\n                try {\n                        this.voiceSource.stop();\n                } catch(e) {}\n        }\n\n        cancelQueue() {\n                this.willCancel = true;\n        }\n\n\n        updateAnim() {\n                if (this.event.timer === 0)\n                        this.sprite.gotoAndPlay(this.event.cur().anim);\n                this.event.timer++;\n                BonziHandler.needsUpdate = true;\n                if (this.event.timer >= this.event.cur().ticks)\n                        this.eventNext();\n        }\n\n        updateText() {\n                if (this.event.timer === 0) {\n                        this.$dialog.css(\"display\", \"block\");\n                        this.event.timer = 1;\n                        this.talk(\n                                this.event.cur().text,\n                                this.event.cur().say,\n                                true\n                        );\n                }\n                \n                if (this.$dialog.css(\"display\") == \"none\")\n                        this.eventNext();\n        }\n\n        updateIdle() {\n                var goNext =\n                        (this.sprite.currentAnimation == \"idle\") &&\n                        (this.event.timer === 0);\n\n                goNext = goNext ||\n                        this.data.pass_idle.indexOf(\n                                this.sprite.currentAnimation\n                        ) != -1;\n\n                if (goNext)\n                        this.eventNext();\n                else {\n                        if (this.event.timer === 0) {\n                                this.tmp_idle_start =\n                                        this.data.to_idle[this.sprite.currentAnimation];\n                                this.sprite.gotoAndPlay(this.tmp_idle_start);\n                                this.event.timer = 1;\n                        }\n                        \n                        if (this.tmp_idle_start != this.sprite.currentAnimation)\n                                if (this.sprite.currentAnimation == \"idle\")\n                                        this.eventNext();\n\n                        BonziHandler.needsUpdate = true;\n                }\n        }\n\n        updateRandom() {\n                var add = this.event.cur().add;\n                var index = Math.floor(add.length * this.rng());\n\n                var e = this.eventMake(add[index]);\n                this.eventNext();\n                this.eventQueue.unshift(e);\n        }\n\n        update() {\n                if (!this.run) return; \n                // ========================================================================\n                // EVENTS\n                // \"the fun part\"\n                // ========================================================================\n\n                if ((this.eventQueue.length !== 0) && (this.eventQueue[0].index >= this.eventQueue[0].list.length))\n                        this.eventQueue.splice(0,1);\n\n                this.event = this.eventQueue[0];\n\n                if ((this.eventQueue.length !== 0) && this.eventRun) {\n                        var eventType = this.event.cur().type;\n                        try {\n                                this[this.eventTypeToFunc[eventType]]();\n                        } catch(e) { this.event.index++; }\n                }\n\n                if (this.willCancel) {\n                        this.cancel();\n                        this.willCancel = false;\n                }\n\n                if (this.needsUpdate) {\n                        this.stage.update();\n                        this.needsUpdate = false;\n                }\n        }\n\n        eventNext() {\n                this.event.timer = 0;\n                this.event.index += 1;\n        }\n\n        talk(text, say, allowHtml) {\n                allowHtml = allowHtml || false;\n                text = replaceAll(text, \"{NAME}\", this.userPublic.name);\n                text = replaceAll(text, \"{COLOR}\", this.color);\n                if (typeof say !== \"undefined\") {\n                        say = replaceAll(say, \"{NAME}\", this.userPublic.name);\n                        say = replaceAll(say, \"{COLOR}\", this.color);\n                } else {\n                        say = text.replace(\"&gt;\", \"\");\n                }\n\n                text = linkify(text);\n                var greentext = \n                        (text.substring(0, 4) == \"&gt;\") ||\n                        (text[0] == \">\");\n\n                this.$dialogCont\n                        [allowHtml ? \"html\" : \"text\"](text)\n                        [greentext ? \"addClass\" : \"removeClass\"](\"bubble_greentext\")\n                        .css(\"display\", \"block\");\n\n                this.stopSpeaking();\n\n                this.goingToSpeak = true;\n\n                speak.play(say, {\n                        \"pitch\": this.userPublic.pitch,\n                        \"speed\": this.userPublic.speed\n                }, () => { // onended\n                        this.clearDialog()\n                }, (source) => {\n                        if (!this.goingToSpeak) source.stop();\n                        this.voiceSource = source;\n                });\n        }\n\n        joke() { this.runSingleEvent(this.data.event_list_joke); }\n\n        fact() { this.runSingleEvent(this.data.event_list_fact); }\n\n        exit(callback) {\n                this.runSingleEvent([{\n                        type: \"anim\",\n                        anim: \"surf_away\",\n                        ticks: 30\n                }]);\n                setTimeout(callback, 2000);\n        }\n\n        deconstruct() {\n                this.stopSpeaking();\n                BonziHandler.stage.removeChild(this.sprite);\n                this.run = false;\n                this.$element.remove();\n        }\n\n        updateName() { this.$nametag.text(this.userPublic.name); }\n\n        youtube(vid) {\n                if (!this.mute) {\n                        var tag = \"iframe\";\n                        this.$dialogCont\n                                .html(`\n                                        <${tag} type=\"text/html\" width=\"173\" height=\"173\" \n                                        src=\"https://www.youtube.com/embed/${vid}?autoplay=1\" \n                                        style=\"width:173px;height:173px\"\n                                        frameborder=\"0\"\n                                        allowfullscreen=\"allowfullscreen\"\n                                        mozallowfullscreen=\"mozallowfullscreen\"\n                                        msallowfullscreen=\"msallowfullscreen\"\n                                        oallowfullscreen=\"oallowfullscreen\"\n                                        webkitallowfullscreen=\"webkitallowfullscreen\"\n                                        ></${tag}>\n                                `)\n                        this.$dialog.show();\n                }\n        }\n\n        backflip(swag) {\n                var event = [{\n                        type: \"anim\",\n                        anim: \"backflip\",\n                        ticks: 15\n                }];\n                if (swag) {\n                        event.push({\n                                type: \"anim\",\n                                anim: \"cool_fwd\",\n                                ticks: 30\n                        });\n                        event.push({\n                                type: \"idle\"\n                        });\n                }\n                this.runSingleEvent(event);\n        }\n\n        updateDialog() {\n                // ========================================================================\n                // DIALOG BOX\n                // ========================================================================\n                var max = this.maxCoords();\n                if (this.data.size.x + this.$dialog.width() > max.x) {\n                        if (this.y < (this.$container.height() / 2) - (this.data.size.x / 2)) {\n                                this.$dialog\n                                        .removeClass(\"bubble-top\")\n                                        .removeClass(\"bubble-left\")\n                                        .removeClass(\"bubble-right\")\n                                        .addClass(\"bubble-bottom\");\n                        } else {\n                                this.$dialog\n                                        .removeClass(\"bubble-bottom\")\n                                        .removeClass(\"bubble-left\")\n                                        .removeClass(\"bubble-right\")\n                                        .addClass(\"bubble-top\");\n                        }\n                } else {                \n                        if (this.x < (this.$container.width() / 2) - (this.data.size.x / 2)) {\n                                this.$dialog\n                                        .removeClass(\"bubble-left\")\n                                        .removeClass(\"bubble-top\")\n                                        .removeClass(\"bubble-bottom\")\n                                        .addClass(\"bubble-right\");\n                        } else {\n                                this.$dialog\n                                        .removeClass(\"bubble-right\")\n                                        .removeClass(\"bubble-top\")\n                                        .removeClass(\"bubble-bottom\")\n                                        .addClass(\"bubble-left\");\n                        }\n                }\n        }\n\n        maxCoords() {\n                return {\n                        x: this.$container.width() - this.data.size.x,\n                        y: this.$container.height() - this.data.size.y - $(\"#chat_bar\").height()\n                };\n        }\n\n        asshole(target) {\n                this.runSingleEvent(\n                        [{\n                                type: \"text\",\n                                text: \"Hey, \" + target + \"!\"\n                        }, {\n                                type: \"text\",\n                                text: \"You're a fucking asshole!\",\n                                say: \"your a fucking asshole!\"\n                        }, {\n                                type: \"anim\",\n                                anim: \"grin_fwd\",\n                                ticks: 15\n                        }, {\n                                type: \"idle\"\n                        }]\n                );\n        }\n        \n        owo(target) {\n                this.runSingleEvent(\n                        [{\n                                type: \"text\",\n                                text: `*notices ${target}'s BonziBulgeâ„¢*`,\n                                say: `notices ${target}s bonzibulge`\n                        }, {\n                                type: \"text\",\n                                text: \"owo, wat dis?\",\n                                say: \"oh woah, what diss?\"\n                        }]\n                );\n        }\n\n        updateSprite(hide) {\n                var stage = BonziHandler.stage;\n                this.cancel();\n                stage.removeChild(this.sprite);\n                if (this.colorPrev != this.color) {\n                        delete this.sprite;\n                        this.sprite = new createjs.Sprite(\n                                BonziHandler.spriteSheets[this.color],\n                                hide ? \"gone\" : \"idle\"\n                        );\n                }\n                stage.addChild(this.sprite);\n                this.move();\n        }\n}"]}